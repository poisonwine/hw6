## 退化图像的复原实验报告
#### 自动化66 杨德宇 2161500050
#### 摘要
&emsp;&emsp;本实验基于MATLAB的实验平台，首先分别对附件图像进行了高斯噪声和椒盐噪声的退化处理 ，然后利用多种不同空域滤波器（包含算术均值，几何均值，谐波均值，逆谐波均值，中值和中点滤波器）对图像进行了复原处理，以SSIM指数进行衡量标准，比较了几种滤波器对于不同噪声的效果，分析了其优劣；接着从退化模型入手推导了维纳滤波器的实现方程，利用教材中的退化函数对图像进行了模糊处理，然后加入均值为0，方差为0.01的高斯噪声，利用维纳滤波器和约束最小二乘滤波器对图像进行了复原处理，对比了自编函数与MATLAB自带函数的区别。

#### 一.图像退化/复原过程模型
&emsp;&emsp;如下图所示，退化过程被建模为一个退化函数和一个加性噪声项，一幅输入图像f(x,y)进行处理，产生一幅退化后的图像g(x,y)。给定g(x,y)和关于退化函数H和加性噪声项的一些知识后，图像复原就是获得原始图像的一个估计f'(x,y)。通常我们希望这一估计尽可能接近原始输入图像。而复原图像主要是以不同类型的图像复原滤波器为基础的。

<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E5%9B%BE%E5%83%8F%E5%A4%8D%E5%8E%9F.png"/>

#### 二.几种复原滤波器
&emsp;&emsp;当仅存在加性噪声的情况下，可以选择空间滤波方法。几种常用的滤波器函数表达式如下：
* 算术均值滤波器：<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E7%AE%97%E6%9C%AF%E5%9D%87%E5%80%BC.png"/>
* 几何均值滤波器：<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E5%87%A0%E4%BD%95%E5%9D%87%E5%80%BC.png"/>
* 谐波均值滤波器：<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E8%B0%90%E6%B3%A2%E5%9D%87%E5%80%BC.png"/>
* 逆谐波均值滤波器：<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E9%80%86%E8%B0%90%E6%B3%A2%E5%9D%87%E5%80%BC.png"/>
* 中值滤波器：<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A2%E5%99%A8.png"/>
* 中点滤波器：<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E4%B8%AD%E7%82%B9%E6%BB%A4%E6%B3%A2%E5%99%A8.png"/>

&emsp;&emsp;几种滤波器的MATLAB代码实现见`源代码.md`。
 
 #### 三.图像质量评价指标SSIM
 &emsp;&emsp;2002年，Wang Zhou和Bovik等人在多年对图像处理、图像压缩及图像视觉质量评价的研究工作基础上，首次提出了结构信息的概念。他们认为：人眼视觉的主要功能是提取背景中的结构信息，而且人眼视觉系统能高度自适应地实现这一目标，因此对图像的结构失真的度量应是图像感知质量的最好近似。在此基础上给出了一种符合人眼视觉系统特性的图像质量客观评判标准-结构相似度（Structure Similaruty,SSIM）。

&emsp;&emsp;大多数的基于误差敏感度（error sensitivity）的质量评估方法(如MSE,PSNR)使用线性变换来分解图像信号，这不会涉及到相关性。我们要讨论的SSIM就是要找到更加直接的方法来比较失真图像和参考图像的结构。
 
<img src="https://github.com/poisonwine/hw6/blob/master/picture/ssim.png"/>

&emsp;&emsp;由SSIM测量系统可得相似度的测量可由三种对比模块组成，分别为：亮度，对比度，结构。三个模块的具体定义可参考论文`Z. Wang, A. C. Bovik, H. R. Sheikh and E. P. Simoncelli, “Image quality assessment: From error visibility to structural similarity”`，在这里给出SSIM的综合计算式：

<img src="https://github.com/poisonwine/hw6/blob/master/picture/ssim2.png"/>

&emsp;&emsp;而在图像质量评估中，局部求SSIM指数的效果要好于全局，故实验中通常加一个8*8的矩形窗对图像进行遍历，以平均SSIM指数作为衡量图像质量的标准，即：

<img src="https://github.com/poisonwine/hw6/blob/master/picture/ssim3.png"/>

#### 四.空间滤波器图像复原
#### 4.1 高斯噪声
&emsp;&emsp;利用MATLAB自带对lena图像加入高斯噪声，均值分别为0和0.2，方差都为0.02，效果如下：

<img src="https://github.com/poisonwine/hw6/blob/master/picture/u%3D0.png" width="400"/> <img src="https://github.com/poisonwine/hw6/blob/master/picture/u%3D0.2.png"  width="400"/> 

&emsp;&emsp;当高斯噪声均值不变为0时，随着方差增加，图像噪声越严重；当高斯噪声方差不变时，均值会影响到整个图像的灰度值，使整个图像变亮。与理论上均值和方差对图像的影响一致。

&emsp;&emsp;利用几种常见的空间滤波器对两幅加入高斯噪声的图像进行滤波，效果如下：

<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E7%AE%97%E6%9C%AF%E5%9D%87%E5%80%BC1.png" /> 
<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E5%87%A0%E4%BD%95%E5%9D%87%E5%80%BC1.png"  /> 
<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E8%B0%90%E6%B3%A2%E5%9D%87%E5%80%BC1.png" "/> 
<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E4%B8%AD%E5%80%BC%E6%BB%A4%E6%B3%A21.png"  /> 
<img src="https://github.com/poisonwine/hw6/blob/master/picture/%E4%B8%AD%E7%82%B9%E6%BB%A4%E6%B3%A21.png" /> 
                                                                                                          
&emsp;&emsp;几种滤波器对图像复原后的SSIM指数如下表所示。可以观察到，对于高斯噪声，算术均值滤波是其中效果最好的。对于零均值的高斯噪声，中值滤波和中点滤波表现也较好，但对于有均值的高斯噪声，就表现得不那么好，相反是几何均值滤波和谐波均值滤波效果较好。

|滤波器类型        | SSIM指数（均值0，方差0.02）         | SSIM指数（均值0.2，方差0.02）         |
| ------------- |:-------------:|:------------- |
| 算术均值滤波      | 0.6933 |0.6086|
| 中值滤波      | 0.6377      | 0.5599|
| 几何均值滤波 | 0.5092      |0.5770|
| 谐波均值滤波 | 0.4678      |0.5647|
| 中点滤波 | 0.6080      |0.5397|

#### 4.1 椒盐噪声
